---
layout    : post
title     : "SD-WAN拓扑概览"
date      : 2023-09-13
lastupdate: 2023-09-13
categories: tick
---

----

# 一、 SD-WAN2组件构成

整体拓扑

![image-20230531172550086](/assets/img/2023-05-31-sdwan-topo-zh/image-20230531172550086.png)

## 1. SD-WAN2 控制器部署环境

### 1.1 控制器核心服务

控制器，部署在K8s集群上，集群由master节点和若干和 worker 节点组成。主要提供HTTP API服务、控制器服务、QUIC通信服务、监控服务等。

HTTP API服务：提供 API 给 Console、BOSS、SDK 等调用；

配置引擎服务：通过实时拓扑和链路负载、质量检测等方式生成网络配置，异步下发至纳管的 CORE、VPE、CPE 节点；

监控服务 ：监控数据由 CPE 上报，经过整理后发送给 CloudSat 平台，提供监控告警服务。

信道管理：对组件间的数据通信链路进行管理和维护，使其具有高效性、安全性和可靠性

设备管理：对设备进行统一和集中的管理，包括配置设备参数、监控设备状态和性能、升级设备的软件和固件等操作

### 1.2 Console

提供了设备管理、网络管理、安全管理、路由信息、监控信息、操作日志等功能。

![image-20230531155110822](/assets/img/2023-05-31-sdwan-topo-zh/image-20230531155110822.png)

### 1.3 BOSS

提供了接入点、核心网、连接云网等管理功能。

![image-20230531155251269](/assets/img/2023-05-31-sdwan-topo-zh/image-20230531155251269.png)

### 1.4 监控告警服务

监控数据由 CPE 上报，经过整理后发送给 CloudSat 平台，提供监控告警服务。

![image-20230531155558643](/assets/img/2023-05-31-sdwan-topo-zh/image-20230531155558643.png)

### 1.5 PAAS组件服务

控制器后台依赖的组件，可以自己部署或使用云厂商提供的高可用 PAAS 服务。

- Etcd

- Redis

- Kafka

- DGraph

- PostgreSQL


### 1.6 镜像仓库

存放 vCPE、base、部署在 k8s 上的控制器镜像。

![image-20230531155729893](/assets/img/2023-05-31-sdwan-topo-zh/image-20230531155729893.png)

### 1.7 负载均衡器 & 域名

控制器的 API  通过域名访问，一个域名下可以绑定多个公网地址。

多个公网地址的访问流量经由 LB 可以自动分配到多台worker 节点上。

![image-20230531155846970](/assets/img/2023-05-31-sdwan-topo-zh/image-20230531155846970.png)

### 1.8 对象存储

存放 CPE 组件的升级包，供设备升级功能使用。



## 2. CORE、VPE组件部署环境

 CORE 和 VPE 节点共同组成了 SDWAN2.0 的核心网。CORE 节点承担路由分发、控制等功能，VPE 节点提供隧道接入和数据包转发能力。

CORE 和 VPE 节点环境：

- Ubuntu20.04 操作系统，物理机和 VM 都可以，VM 推荐选用网络增强型；
- 每台节点都要绑定公网 IP；
- 推荐 2 个 CORE 和 8 个 VPE，每个 POP 点最低 2 台 VPE；



## 3. 接入设备（CPE，vCPE）

### vCPE

VCPE 是 SD-WAN（新版）软件版本，包含 **VCPE 虚拟机**和 **VCPE 容器**，通过将软件 VCPE 部署在您网络的宿主机中，使宿主机作为一个光盒 CPE 设备为您提供上云服务，突破了物理的限制，更加灵活地帮您将网络接入连接云网。

虚拟机形式的 vCPE 通过镜像部署，其他云平台上也可提供镜像。

部署方式参照官网文档：[部署软件 VCPE - 公有云文档中心 (qingcloud.com)](https://docsv4.qingcloud.com/user_guide/sd_wan/sdwan_new/open_access_point/vcpe/40_deploy_script/)

### 物理光盒

光盒 CPE 可帮助用户通过互联网 "最后一公里" 快速接入到 POP，实时监控隧道质量，根据客户业务特性可以选择 HA 主备部署模式，具备零配置部署、即插即用、动态链路切换、高可用等特性。

| 类型         | 架构 | 内网带宽 | 规格                                                         |
| ------------ | ---- | -------- | ------------------------------------------------------------ |
| AG-100       | X86  |          |                                                              |
| AG-102       | ARM  |          |                                                              |
| 光盒 2 号    | X86  | 100 Mbps | WAN 侧支持互联网带宽（RJ45/光纤）、4G 全网通接入、LAN 侧支持有线和 WIFI 接入。 |
| 智能边缘网关 | X86  |          |                                                              |
